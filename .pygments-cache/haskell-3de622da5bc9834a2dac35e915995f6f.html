<div class="highlight"><pre><span class="c1">-- inserting at an index, using foldr</span>
<span class="nf">insertAt</span> <span class="ow">::</span> <span class="n">a</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="ow">-&gt;</span> <span class="kt">Int</span> <span class="ow">-&gt;</span> <span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="nf">insertAt</span> <span class="n">x</span> <span class="n">ys</span> <span class="n">n</span> <span class="ow">=</span> <span class="n">foldr</span> <span class="n">insertHelper</span> <span class="kt">[]</span> <span class="o">$</span> <span class="n">zip</span> <span class="p">[</span><span class="mi">0</span><span class="o">..</span><span class="p">]</span> <span class="n">ys</span>
    <span class="kr">where</span> 
        <span class="n">insertHelper</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="n">acc</span> <span class="ow">=</span> <span class="kr">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">n</span>
            <span class="kr">then</span> <span class="n">x</span> <span class="kt">:</span> <span class="n">y</span> <span class="kt">:</span> <span class="n">acc</span>
            <span class="kr">else</span> <span class="n">y</span> <span class="kt">:</span> <span class="n">acc</span>
</pre></div>